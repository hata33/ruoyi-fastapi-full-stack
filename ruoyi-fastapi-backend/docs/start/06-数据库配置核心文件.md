我将为 database.py 文件添加详细的注释，解释其功能和语法内容。现在开始修改文件。
我已经为 database.py 文件添加了详细的注释。下面是对该文件功能和语法的简要总结：

## database.py 文件总结

### 文件功能概述

这个文件是 RuoYi-Vue3-FastAPI 项目的数据库配置核心文件，主要负责：

1. **数据库连接配置**：根据环境配置构建数据库连接 URL
2. **异步数据库引擎创建**：创建并配置 SQLAlchemy 异步引擎
3. **会话工厂定义**：创建用于生成数据库会话的工厂函数
4. **ORM 基类定义**：提供所有数据库模型的基类

### 主要组件解析

1. **导入部分**：
   - 导入 SQLAlchemy 异步扩展组件：`create_async_engine`、`async_sessionmaker`、`AsyncAttrs`
   - 导入 SQLAlchemy ORM 基类：`DeclarativeBase`
   - 导入 URL 编码工具：`quote_plus`
   - 导入数据库配置：`DataBaseConfig`

2. **数据库连接 URL 构建**：
   - 根据配置的数据库类型（MySQL 或 PostgreSQL）构建不同的连接 URL
   - 使用 `quote_plus` 对密码进行 URL 编码，确保特殊字符安全
   - 支持 MySQL（使用 asyncmy 驱动）和 PostgreSQL（使用 asyncpg 驱动）

3. **异步数据库引擎创建**：
   - 使用 `create_async_engine` 创建异步数据库引擎
   - 配置连接池参数：大小、溢出连接数、回收时间、超时时间
   - 配置 SQL 语句打印选项，用于调试

4. **异步会话工厂定义**：
   - 使用 `async_sessionmaker` 创建异步会话工厂
   - 配置事务自动提交和自动刷新选项
   - 将会话工厂绑定到创建的异步引擎

5. **ORM 基类定义**：
   - 创建 `Base` 类作为所有 ORM 模型的基类
   - 继承 `AsyncAttrs` 提供异步属性访问功能
   - 继承 `DeclarativeBase` 提供 SQLAlchemy 2.0 的声明式映射功能

### 技术特点

1. **异步数据库操作**：
   - 使用 SQLAlchemy 2.0 的异步 API
   - 支持异步属性访问和关系加载

2. **多数据库支持**：
   - 根据配置支持 MySQL 和 PostgreSQL
   - 使用对应的异步驱动（asyncmy 和 asyncpg）

3. **连接池管理**：
   - 配置连接池大小和行为
   - 优化数据库连接资源使用

4. **声明式 ORM 模式**：
   - 使用 SQLAlchemy 2.0 的声明式映射
   - 提供统一的 ORM 基类

这个文件虽然代码量不大，但在整个应用中扮演着关键角色，它建立了应用与数据库之间的桥梁，并提供了高效的异步数据库访问机制。通过使用 SQLAlchemy 的异步扩展，该文件实现了现代 Python Web 应用中推荐的异步数据库访问模式，提高了应用的性能和可伸缩性。
