### 路由控制表（controller_list）的定义与注册

- **结构**：路由控制表是一个列表，每个元素是包含 `router` 与 `tags` 的字典，用于集中声明所有模块的路由与分组标签。
```153:185:ruoyi-fastapi-backend/server.py
# 定义系统所有路由控制器列表
controller_list = [
    # 基础功能模块
    {'router': loginController, 'tags': ['登录模块']},  # 用户登录相关API
    {'router': captchaController, 'tags': ['验证码模块']},  # 验证码生成与验证API
    
    # 系统管理模块
    {'router': userController, 'tags': ['系统管理-用户管理']},  # 用户CRUD操作API
    {'router': roleController, 'tags': ['系统管理-角色管理']},  # 角色权限管理API
    {'router': menuController, 'tags': ['系统管理-菜单管理']},  # 系统菜单管理API
    {'router': deptController, 'tags': ['系统管理-部门管理']},  # 部门组织结构管理API
    {'router': postController, 'tags': ['系统管理-岗位管理']},  # 岗位管理API
    {'router': dictController, 'tags': ['系统管理-字典管理']},  # 系统字典管理API
    {'router': configController, 'tags': ['系统管理-参数管理']},  # 系统参数配置API
    {'router': noticeController, 'tags': ['系统管理-通知公告管理']},  # 系统公告管理API
    {'router': logController, 'tags': ['系统管理-日志管理']},  # 系统日志查询API
    
    # 系统监控模块
    {'router': onlineController, 'tags': ['系统监控-在线用户']},  # 在线用户监控API
    {'router': jobController, 'tags': ['系统监控-定时任务']},  # 定时任务管理API
    {'router': serverController, 'tags': ['系统监控-菜单管理']},  # 服务器监控API
    {'router': cacheController, 'tags': ['系统监控-缓存监控']},  # 缓存监控API
    
    # 其他功能模块
    {'router': commonController, 'tags': ['通用模块']},  # 通用功能API
    {'router': genController, 'tags': ['代码生成']},  # 代码生成器API
]

# 遍历控制器列表，将每个控制器注册到FastAPI应用
for controller in controller_list:
    app.include_router(router=controller.get('router'), tags=controller.get('tags'))
```
- **新增路由模块的步骤**：
  - 在顶部导入对应模块的 `xxxController`。
  - 向 `controller_list` 追加一条 `{'router': xxxController, 'tags': ['分组名']}`。
  - 其余无需改动，循环会自动注册。

### 应用生命周期（lifespan）

- **启动阶段（yield 之前）**：
  - 记录启动日志与欢迎输出
  - 初始化数据库表
  - 创建并挂载 Redis 连接池到 `app.state.redis`
  - 预热系统字典与系统配置到 Redis
  - 初始化定时任务调度器
- **关闭阶段（yield 之后）**：
  - 关闭 Redis 连接池
  - 关闭定时任务调度器

```106:135:ruoyi-fastapi-backend/server.py
@asynccontextmanager
async def lifespan(app: FastAPI):
    # 记录应用启动日志
    logger.info(f'{AppConfig.app_name}开始启动')
    # 启动欢迎函数
    worship()
    # 初始化并创建数据库表
    await init_create_table()
    # 创建Redis连接池并存储在应用状态中
    app.state.redis = await RedisUtil.create_redis_pool()
    # 初始化系统字典到Redis
    await RedisUtil.init_sys_dict(app.state.redis)
    # 初始化系统配置到Redis
    await RedisUtil.init_sys_config(app.state.redis)
    # 初始化系统调度器
    await SchedulerUtil.init_system_scheduler()
    # 启动成功日志
    logger.info(f'{AppConfig.app_name}启动成功')
    yield
    # 关闭Redis连接池
    await RedisUtil.close_redis_pool(app)
    # 关闭系统调度器
    await SchedulerUtil.close_system_scheduler()
```

- **挂载与全局处理**：在应用实例化后，统一挂载子应用、中间件、异常处理，确保请求在进入路由前已完成通用处理（如 CORS、鉴权、压缩、全局异常等）。

- 我已基于 `server.py` 提炼出核心要点：如何集中维护路由控制表并自动注册、以及生命周期的启动与关闭顺序。